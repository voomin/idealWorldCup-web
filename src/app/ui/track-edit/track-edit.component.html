<ng-container *ngIf="{
    track: makingTrack | async,
    cards: makingCards | async
  } as osb;">
  <div class="container py-3">
    <!-- <h5>
      고치기
    </h5> -->
    <div
      class="p-5 w-100 btn btn-lg btn-outline-primary"
      (click)="fileInput.click()"
      [ngClass]="{
        'btn-primary': dropzoneActive,
        'text-white': dropzoneActive
      }"
      fileDrop
      (filesDropped)="uploadFile(osb.track.id, $event)"
      (filesHovered)="dropzoneState($event)"
    >
      <h1><fa-icon [icon]="faFileUpload"></fa-icon></h1>
      <p>이미지를 업로드 하세요</p>
      <input
        hidden
        type="file"
        #fileInput
        multiple
        (change)="uploadFile(osb.track.id, $event.target.files)"
      />
    </div>
    <div class="card-columns mt-3">
        <ng-container *ngFor="let card of osb.cards; let i = index">
          <div class="card">
            <ng-container
              *ngIf="
                (card.imgUploadingSize / card.imgTotalSize) * 100 as percentNum
              "
            >
              <p class="card-text" *ngIf="100 > percentNum">
                <ngb-progressbar
                  type="info"
                  [value]="percentNum"
                  [striped]="true"
                  [animated]="true"
                >
                  <i>{{ percentNum }}%</i>
                </ngb-progressbar>
              </p>
            </ng-container>
            <p *ngIf="!card.imgUploadingSize">
              <ngb-progressbar
                type="info"
                [value]="100"
                height=".5rem"
                [striped]="true"
                [animated]="true"
              ></ngb-progressbar>
            </p>
            <img
              *ngIf="card.photoURL"
              src="{{ card.photoURL }}"
              class="card-img-top"
              alt="..."
            />
            <div class="card-body">
              <div class="form-group">
                <label for="cardInputTitle" class="card-title">카드제목</label>
                <input
                  type="text"
                  class="form-control"
                  id="cardInputTitle"
                  [value]="card.title"
                  (change)="cardTitleChange(card.id, $event)"
                />
                <!-- <small id="emailHelp" class="form-text text-muted">이미지에 대한 글귀를 입력해주세요.</small> -->
              </div>
              <p class="small text-muted text-right font-italic ">
                <span
                  (click)="deleteCard(card.id)"
                  style="cursor: pointer;"
                  title="임시저장된 해당카드의 이미지와 정보를 삭제합니다"
                  >삭제</span
                >
              </p>
            </div>
          </div>
        </ng-container>
    </div>
    <div class="form-group">
        <label for="exampleInputTitle">이상형월드컵 제목 </label>
        <input
          type="title"
          class="form-control"
          id="exampleInputTitle"
          aria-describedby="titleHelp"
          placeholder="Enter Title"
          value="{{ osb.track?.title }}"
          (change)="trackTitleChange(osb.track.id, $event)"
        />
      </div>
      <div class="form-group">
        <label for="exampleFormControlTextarea1">설명</label>
        <textarea
          class="form-control"
          id="exampleFormControlTextarea1"
          rows="3"
          placeholder="Enter information about this Track"
          value="{{ osb.track?.info }}"
          (change)="trackInfoChange(osb.track.id, $event)"
        ></textarea>
      </div>

    <!-- <button type="submit" class="btn btn-outline-secondary mr-2">save</button> -->
    <button class="btn btn-primary" *ngIf="osb.cards?.length >= 2; else cardLack">게시</button>
    <ng-template #cardLack>
      <p class="font-italic small text-secondary">게시하려면 카드를 2개 이상 등록하세요.</p>
    </ng-template>
    
  </div>
</ng-container>
<!-- 
<ng-template #newTrack>
  <div class="container text-center">
      <div class="spinner-border text-primary" role="status">
          <span class="sr-only">Loading...</span>
        </div>
  </div>
</ng-template> -->
